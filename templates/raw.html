{% extends 'base.html' %}

{% block title %}Raw Content - Pasted IR{% endblock %}

{% block description %}View raw paste content{% endblock %}

{% block extra_head %}
<style>
    .raw-content {
        font-family: 'Courier New', monospace;
        font-size: 14px;
        line-height: 1.5;
        white-space: pre-wrap;
        word-wrap: break-word;
        background-color: var(--code-bg);
        border: 1px solid var(--code-border);
        border-radius: 8px;
        padding: 20px;
        margin: 0;
        color: var(--text-primary);
        transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
    }
    
    .highlight-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 8px 12px;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .highlight-toggle:hover {
        background: var(--bg-secondary);
    }
    
    .raw-only {
        font-family: 'Courier New', monospace;
        font-size: 14px;
        line-height: 1.5;
        white-space: pre-wrap;
        word-wrap: break-word;
        background-color: var(--bg-primary);
        color: var(--text-primary);
        padding: 20px;
        margin: 0;
        min-height: 100vh;
        box-sizing: border-box;
    }
</style>
{% endblock %}

{% block content %}
{% if content %}
    <div class="highlight-toggle" id="highlightToggle" title="Toggle syntax highlighting">
        <span id="toggleText">üîç Highlight</span>
    </div>
    
    <div id="highlightedContent" class="card rounded-lg overflow-hidden">
        <pre class="raw-content"><code class="language_{{ lang.alias }}">{{ content }}</code></pre>
    </div>
    
    <div id="rawContent" class="raw-only" style="display: none;">{{ content }}</div>
{% elif error %}
    <div class="card rounded-lg p-6">
        <p class="text-red-500 text-lg">{{ error }}</p>
    </div>
{% elif has_password %}
    <div class="card rounded-lg p-6 max-w-md mx-auto">
        <h2 class="text-xl font-semibold mb-4 text-theme-primary">Password Protected</h2>
        <p class="text-theme-secondary mb-4">Please enter the password to view the paste:</p>
        <form method="POST" class="space-y-4">
            {% csrf_token %}
            <div>
                <label for="password" class="block text-theme-primary font-semibold mb-2">Password:</label>
                <input 
                    type="password" 
                    name="password" 
                    id="password" 
                    required 
                    class="w-full border border-theme rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="Enter password"
                >
            </div>
            <button type="submit" class="w-full bg-blue-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                View Paste
            </button>
        </form>
    </div>
{% else %}
    <div class="card rounded-lg p-6">
        <p class="text-theme-secondary text-lg">No content available.</p>
    </div>
{% endif %}
{% endblock %}

{% block extra_scripts %}
{% if content %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const highlightToggle = document.getElementById('highlightToggle');
        const highlightedContent = document.getElementById('highlightedContent');
        const rawContent = document.getElementById('rawContent');
        const toggleText = document.getElementById('toggleText');
        
        let isHighlighted = true;
        
        highlightToggle.addEventListener('click', function() {
            if (isHighlighted) {
                // Switch to raw view
                highlightedContent.style.display = 'none';
                rawContent.style.display = 'block';
                toggleText.textContent = 'üé® Highlight';
                isHighlighted = false;
            } else {
                // Switch to highlighted view
                highlightedContent.style.display = 'block';
                rawContent.style.display = 'none';
                toggleText.textContent = 'üîç Raw';
                isHighlighted = true;
                
                // Re-highlight if highlight.js is available
                if (typeof hljs !== 'undefined') {
                    setTimeout(() => {
                        hljs.highlightAll();
                    }, 100);
                }
            }
        });
        
        // Keyboard shortcut for toggle (Ctrl/Cmd + H)
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'h') {
                e.preventDefault();
                highlightToggle.click();
            }
        });
    });
</script>
{% endif %}
{% endblock %} 